#!/bin/bash

sudo mkdir -p -m 755 /usr/local/etc/colte
sudo chown $USER:$USER /usr/local/etc/colte
rm -rf /usr/local/etc/colte/coltenv

# scripts check for this first line to know that all vars are loaded
echo "#!/bin/bash" | tee --append /usr/local/etc/colte/coltenv
echo "export COLTENV=1" | tee --append /usr/local/etc/colte/coltenv

# Base directory for the whole project source
BASEDIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
echo "export COLTE_DIR=$BASEDIR" | tee --append /usr/local/etc/colte/coltenv
CURRENTUSER=$USER
echo "export COLTE_USER=$CURRENTUSER" | tee --append /usr/local/etc/colte/coltenv

#############################################################
#################### COMPILATION OPTIONS ####################
#############################################################

# Target distro for build/install/config/etc.
# Accepted values are "stretch" (Debian 9) and "bionic" (Ubuntu-18.04)
# Cross-compilation IS NOT tested or supported!!!
echo "export COLTE_DISTRO=bionic" | tee --append /usr/local/etc/colte/coltenv

# These options download/compile source into .deb packages, as opposed to using apt-get
echo "export COLTE_BUILD_LIBRARIES=0" | tee --append /usr/local/etc/colte/coltenv
echo "export COLTE_BUILD_EPC=0" | tee --append /usr/local/etc/colte/coltenv
echo "export COLTE_BUILD_MEDIA=1" | tee --append /usr/local/etc/colte/coltenv

# These options turn on/off individual CoLTE modules
echo "export COLTE_EPC=0" | tee --append /usr/local/etc/colte/coltenv
echo "export COLTE_BILLING=0" | tee --append /usr/local/etc/colte/coltenv
echo "export COLTE_WEBGUI=0" | tee --append /usr/local/etc/colte/coltenv
echo "export COLTE_MEDIA=0" | tee --append /usr/local/etc/colte/coltenv
echo "export COLTE_WIKI=0" | tee --append /usr/local/etc/colte/coltenv
echo "export COLTE_MAP=0" | tee --append /usr/local/etc/colte/coltenv
echo "export COLTE_CHAT=0" | tee --append /usr/local/etc/colte/coltenv
echo "export COLTE_EMERGENCY=0" | tee --append /usr/local/etc/colte/coltenv
echo "export COLTE_ZOTAC=0" | tee --append /usr/local/etc/colte/coltenv

### IMS IS DISABLED FOR NOW - DO NOT USE! ###
# echo "export COLTE_IMS=1" | tee --append /usr/local/etc/colte/coltenv
# echo "export COLTE_ENBRAINS=0" | tee --append /usr/local/etc/colte/coltenv

source /usr/local/etc/colte/coltenv
